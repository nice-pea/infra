http:
  routers: # ========================= ROUTERS =========================
    traefik:
      entryPoints:
        - websecure
      rule: Host(`traefik.dsaime.ru`)
      middlewares:
        - traefik-auth
      tls:
        certResolver: cloudflare
      service: api@internal

    grafana:
      entryPoints:
        - websecure
      rule: Host(`grafana.dsaime.ru`)
      tls:
        certResolver: cloudflare
      service: grafana

    3xui:
      entryPoints:
        - websecure
      rule: Host(`3xui.dsaime.ru`)
      tls:
        certResolver: cloudflare
      service: 3xui

    loki:
      entryPoints:
        - websecure
      rule: Host(`loki.dsaime.ru`)
      middlewares:
        - loki-auth
      tls:
        certResolver: cloudflare
      service: loki

    adminer:
      entryPoints:
        - websecure
      rule: Host(`adminer.dsaime.ru`)
      tls:
        certResolver: cloudflare
      service: adminer

    pgadmin:
      entryPoints:
        - websecure
      rule: Host(`pgadmin.dsaime.ru`)
      tls:
        certResolver: cloudflare
      service: pgadmin

    npchat-api:
      entryPoints:
        - websecure
      rule: Host(`api.npchat.dsaime.ru`)
      tls:
        certResolver: cloudflare
      service: npchat-api

    fallback:
      rule: "PathPrefix(`/`)"
      priority: 1  # Самый низкий приоритет
      service: caddy-proxy


  services: # ========================= SERVICES =========================
    grafana:
      loadBalancer:
        servers:
          - url: http://grafana:3000

    3xui:
      loadBalancer:
        servers:
          - url: http://3x-ui:2053
    loki:
      loadBalancer:
        servers:
          - url: http://loki:3100

    adminer:
      loadBalancer:
        servers:
          - url: http://adminer:8080

    pgadmin:
      loadBalancer:
        servers:
          - url: http://pgadmin:80

    npchat-api:
      loadBalancer:
        servers:
          - url: http://npc.npchat:8080

    caddy-proxy:
      loadBalancer:
        servers:
          - url: "http://caddy:80"


  middlewares: # ========================= MIDDLEWARES =========================
    traefik-auth:
      basicAuth:
        usersFile: /auth/traefik # https://doc.traefik.io/traefik/middlewares/http/basicauth/

    loki-auth:
      basicAuth:
        usersFile: /auth/loki